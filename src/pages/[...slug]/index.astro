---
import { getCollection } from "astro:content";
import About from "../../components/blocks/blocks/About.astro";
import Carousel from "../../components/blocks/blocks/Carousel.astro";
import Contact from "../../components/blocks/blocks/Contact.astro";
import Hero from "../../components/blocks/blocks/Hero.astro";
import Schedule from "../../components/blocks/blocks/Schedule.astro";
import Layout from "../../layouts/Layout.astro";
import { t } from "../../utils/t";

export async function getStaticPaths() {
  const pages = await getCollection("pages");
  const languages = await getCollection("languages");
  const defaultLanguage = languages[0].data;

  const paths = [];
  for (const { data: page } of pages) {
    for (const { data: language } of languages) {
      if (language.code === defaultLanguage.code) {
        paths.push({
          params: { slug: page.slug || undefined },
          props: {
            page: page,
            lang: defaultLanguage,
          },
        });
      } else {
        paths.push({
          params: {
            slug: page.slug ? `${language.code}/${page.slug}` : language.code,
          },
          props: {
            page: page,
            lang: language,
          },
        });
      }
    }
  }
  return paths;
}

const { page, lang } = Astro.props;

const title = t(page.seo.title, lang.code);
const description = t(page.seo.description, lang.code);
const og_image = t(page.seo.og_image, lang.code);
---

<Layout title={title} description={description} og_image={og_image} lang={lang.code}>
  <Hero />
  <Carousel />
  <Schedule />
  <About />
  <Contact />
</Layout>
