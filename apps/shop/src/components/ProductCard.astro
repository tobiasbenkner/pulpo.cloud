---
import type { Product } from '../types/shop';

interface Props {
    product: Product;
}

const { product } = Astro.props;

// Prüfen, ob ein Bild vorhanden ist (nicht null, nicht undefined, nicht leer)
const hasImage = product.image && product.image.trim() !== '';
---

<button
    class="product-card group flex flex-col h-full bg-white rounded-xl border border-zinc-200 overflow-hidden active:scale-95 active:border-zinc-400 active:bg-zinc-50 text-left shadow-sm hover:shadow-md transition-shadow"
    data-category={product.category}
    onclick={`window.shop.add('${JSON.stringify(product)}')`}
>
    <!-- Bild Container (Bleibt immer aspect 3:2 damit das Grid gleichmäßig ist) -->
    <div class="relative w-full aspect-[3/2] overflow-hidden bg-zinc-100 border-b border-zinc-50">
        
        {hasImage ? (
            // FALL 1: BILD VORHANDEN
            <img
                src={product.image}
                alt={product.name}
                class="w-full h-full object-cover mix-blend-multiply"
                loading="lazy"
            />
        ) : (
            // FALL 2: KEIN BILD (Platzhalter)
            <div class="w-full h-full flex items-center justify-center bg-zinc-50">
                <!-- Subtiles Icon oder Initialen -->
                <svg class="w-8 h-8 text-zinc-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
            </div>
        )}

        <!-- Price Tag (Wird immer angezeigt, egal ob Bild da ist oder nicht) -->
        <div class="absolute bottom-1 right-1 bg-white/95 backdrop-blur-md px-1.5 py-0.5 rounded shadow-sm text-zinc-900 font-bold text-[10px] border border-zinc-100">
            {product.priceGross.toFixed(2)} €
        </div>
    </div>

    <!-- Info Bereich -->
    <div class="p-2 flex flex-col justify-center">
        <p class="text-[9px] font-bold text-zinc-400 uppercase tracking-wide truncate mb-0.5">{product.category}</p>
        <h3 class="font-semibold text-zinc-800 text-xs leading-tight line-clamp-2 min-h-[2.5em]">{product.name}</h3>
    </div>
</button>